<div class="pokemon-list-container">
  <div class="filtros-section">
    <h1>Pokédex</h1>

    <div class="filtros">
      <div class="filtro-group">
        <label for="geracao">Geração:</label>
        <select id="geracao" [value]="geracaoSelecionada()" (change)="onGeracaoChange($any($event.target).value)">
          @for (geracao of geracoes(); track geracao.id) {
          <option [value]="geracao.id">{{ geracao.nome }}</option>
          }
        </select>
      </div>

      <div class="filtro-group">
        <label for="nome">Filtrar por nome:</label>
        <input id="nome" type="text" [value]="nomeFiltro()" (input)="onNomeFiltroChange($any($event.target).value)"
          placeholder="Digite o nome do Pokémon...">
      </div>
    </div>
  </div>

  @if (carregando()) {
  <div class="loading">
    <p>Carregando Pokémon...</p>
  </div>
  }

  @if (erro() && !carregando()) {
  <div class="error">
    <p>{{ erro() }}</p>
    <button (click)="carregarPokemons()">Tentar Novamente</button>
  </div>
  }

  @if (!carregando() && !erro()) {
  <div class="pokemon-grid">
    @for (pokemon of pokemons(); track pokemon.id) {
    <div class="pokemon-card" [class.favorito]="pokemon.favorito" [class.grupo-batalha]="pokemon.grupo_batalha">
      <div class="pokemon-image flex justify-center items-center">
        <img [src]="pokemon.imagem" [alt]="pokemon.nome" loading="lazy">
      </div>

      <div class="pokemon-info">
        <h3 class="pokemon-name font-bold">{{ pokemon.nome | titlecase }}</h3>
        <p class="pokemon-id">#{{ pokemon.id.toString().padStart(3, '0') }}</p>

        <div class="pokemon-types">
          @for (tipo of pokemon.tipos; track tipo) {
          <span [class]="'type-badge ' + getTipoClass(tipo)">
            {{ tipo }}
          </span>
          }
        </div>
      </div>

      <div class="pokemon-actions">
        <button class="btn-favorito" [class.active]="pokemon.favorito" (click)="toggleFavorito(pokemon)"
          [title]="pokemon.favorito ? 'Remover dos favoritos' : 'Adicionar aos favoritos'">
          ♥
        </button>

        <button class="btn-grupo" [class.active]="pokemon.grupo_batalha" (click)="toggleGrupoBatalha(pokemon)"
          [title]="pokemon.grupo_batalha ? 'Remover do grupo' : 'Adicionar ao grupo'">
          ⚔️
        </button>
      </div>

      <div class="status-badges">
        @if (pokemon.favorito) {
        <span class="badge favorito-badge">Favorito</span>
        }
        @if (pokemon.grupo_batalha) {
        <span class="badge grupo-badge">Grupo</span>
        }
      </div>
    </div>
    }
  </div>

  @if (pokemons().length === 0) {
  <div class="no-results">
    <p>Nenhum Pokémon encontrado para os filtros selecionados.</p>
  </div>
  }
  }
</div>
